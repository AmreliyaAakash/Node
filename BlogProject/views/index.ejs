<%- include('partials/header') %>

    <div class="page-header">
        <h1 class="page-title">Latest Stories</h1>
    </div>

    <div class="blog-grid">
        <% if (blogs.length===0) { %>
            <div class="empty-state">
                <h3>No stories published yet</h3>
                <p>Be the first to share your thoughts!</p>
                <br>
                <a href="/new" class="btn btn-primary">Write a Story</a>
            </div>
            <% } %>

                <% blogs.forEach(blog=> { %>
                    <article class="blog-card">
                        <% if (blog.image) { %>
                            <img src="<%= blog.image %>" alt="<%= blog.title %>" class="blog-image">
                            <% } else { %>
                                <div class="blog-image placeholder">
                                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#9CA3AF"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                        <polyline points="21 15 16 10 5 21"></polyline>
                                    </svg>
                                </div>
                                <% } %>
                                    <div class="blog-content">
                                        <p class="blog-date">
                                            <%= blog.createdAt %>
                                        </p>
                                        <h2 class="blog-title">
                                            <%= blog.title %>
                                        </h2>
                                        <p class="blog-excerpt">
                                            <%= blog.content.substring(0, 120) %>
                                                <%= blog.content.length> 120 ? '...' : '' %>
                                        </p>

                                        <div class="blog-footer">
                                            <div class="blog-actions">
                                                <a href="/edit/<%= blog.id %>" class="btn btn-secondary">Edit</a>
                                                <form action="/delete/<%= blog.id %>" method="POST"
                                                    style="display:inline;"
                                                    onsubmit="return confirm('Are you sure you want to delete this story?');">
                                                    <button type="submit" class="btn btn-danger">Delete</button>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                    </article>
                    <% }) %>
    </div>

    <style>
        .blog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2.5rem;
        }

        .blog-card {
            background: var(--card-bg);
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            border: 1px solid #F3F4F6;
        }

        .blog-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            border-color: #E5E7EB;
        }

        .blog-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
        }

        .blog-image.placeholder {
            background: #F9FAFB;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .blog-content {
            padding: 1.5rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .blog-date {
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--primary);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .blog-title {
            font-size: 1.35rem;
            font-weight: 700;
            margin-bottom: 1rem;
            line-height: 1.4;
            color: var(--text-main);
        }

        .blog-excerpt {
            color: var(--text-muted);
            margin-bottom: 2rem;
            flex: 1;
            font-size: 0.95rem;
        }

        .blog-footer {
            margin-top: auto;
            padding-top: 1rem;
            border-top: 1px solid #F3F4F6;
        }

        .blog-actions {
            display: flex;
            gap: 0.75rem;
        }

        .blog-actions .btn {
            flex: 1;
            padding: 0.5rem;
            font-size: 0.875rem;
        }

        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 5rem 2rem;
            background: var(--card-bg);
            border-radius: 1rem;
            color: var(--text-muted);
            border: 2px dashed #E5E7EB;
        }

        .empty-state h3 {
            color: var(--text-main);
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
    </style>

    <%- include('partials/footer') %>